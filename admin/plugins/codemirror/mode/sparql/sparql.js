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 ch;
      while ((ch = stream.next()) != null) {
        if (ch == quote && !escaped) {
          state.tokenize = tokenBase;
          break;
        }
        escaped = !escaped && ch == "\\";
      }
      return "string";
    };
  }

  function pushContext(state, type, col) {
    state.context = {prev: state.context, indent: state.indent, col: col, type: type};
  }
  function popContext(state) {
    state.indent = state.context.indent;
    state.context = state.context.prev;
  }

  return {
    startState: function() {
      return {tokenize: tokenBase,
              context: null,
              indent: 0,
              col: 0};
    },

    token: function(stream, state) {
      if (stream.sol()) {
        if (state.context && state.context.align == null) state.context.align = false;
        state.indent = stream.indentation();
      }
      if (stream.eatSpace()) return null;
      var style = state.tokenize(stream, state);

      if (style != "comment" && state.context && state.context.align == null && state.context.type != "pattern") {
        state.context.align = true;
      }

      if (curPunc == "(") pushContext(state, ")", stream.column());
      else if (curPunc == "[") pushContext(state, "]", stream.column());
      else if (curPunc == "{") pushContext(state, "}", stream.column());
      else if (/[\]\}\)]/.test(curPunc)) {
        while (state.context && state.context.type == "pattern") popContext(state);
        if (state.context && curPunc == state.context.type) {
          popContext(state);
          if (curPunc == "}" && state.context && state.context.type == "pattern")
            popContext(state);
        }
      }
      else if (curPunc == "." && state.context && state.context.type == "pattern") popContext(state);
      else if (/atom|string|variable/.test(style) && state.context) {
        if (/[\}\]]/.test(state.context.type))
          pushContext(state, "pattern", stream.column());
        else if (state.context.type == "pattern" && !state.context.align) {
          state.context.align = true;
          state.context.col = stream.column();
        }
      }

      return style;
    },

    indent: function(state, textAfter) {
      var firstChar = textAfter && textAfter.charAt(0);
      var context = state.context;
      if (/[\]\}]/.test(firstChar))
        while (context && context.type == "pattern") context = context.prev;

      var closing = context && firstChar == context.type;
      if (!context)
        return 0;
      else if (context.type == "pattern")
        return context.col;
      else if (context.align)
        return context.col + (closing ? 0 : 1);
      else
        return context.indent + (closing ? 0 : indentUnit);
    },

    lineComment: "#"
  };
});

CodeMirror.defineMIME("application/sparql-query", "sparql");

});
