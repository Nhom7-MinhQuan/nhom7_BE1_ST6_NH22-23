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                          } // else already in a quoted expression
                            returnType = ATOM;
                        } else {
                            stream.eatWhile(/[\w_\-!$%&*+\.\/:<=>?@\^~]/);
                            returnType = ATOM;
                        }
                    } else if (ch == '#') {
                        if (stream.eat("|")) {                    // Multi-line comment
                            state.mode = "comment"; // toggle to comment mode
                            returnType = COMMENT;
                        } else if (stream.eat(/[tf]/i)) {            // #t/#f (atom)
                            returnType = ATOM;
                        } else if (stream.eat(';')) {                // S-Expr comment
                            state.mode = "s-expr-comment";
                            returnType = COMMENT;
                        } else {
                            var numTest = null, hasExactness = false, hasRadix = true;
                            if (stream.eat(/[ei]/i)) {
                                hasExactness = true;
                            } else {
                                stream.backUp(1);       // must be radix specifier
                            }
                            if (stream.match(/^#b/i)) {
                                numTest = isBinaryNumber;
                            } else if (stream.match(/^#o/i)) {
                                numTest = isOctalNumber;
                            } else if (stream.match(/^#x/i)) {
                                numTest = isHexNumber;
                            } else if (stream.match(/^#d/i)) {
                                numTest = isDecimalNumber;
                            } else if (stream.match(/^[-+0-9.]/, false)) {
                                hasRadix = false;
                                numTest = isDecimalNumber;
                            // re-consume the initial # if all matches failed
                            } else if (!hasExactness) {
                                stream.eat('#');
                            }
                            if (numTest != null) {
                                if (hasRadix && !hasExactness) {
                                    // consume optional exactness after radix
                                    stream.match(/^#[ei]/i);
                                }
                                if (numTest(stream))
                                    returnType = NUMBER;
                            }
                        }
                    } else if (/^[-+0-9.]/.test(ch) && isDecimalNumber(stream, true)) { // match non-prefixed number, must be decimal
                        returnType = NUMBER;
                    } else if (ch == ";") { // comment
                        stream.skipToEnd(); // rest of the line is a comment
                        returnType = COMMENT;
                    } else if (ch == "(" || ch == "[") {
                      var keyWord = ''; var indentTemp = stream.column(), letter;
                        /**
                        Either
                        (indent-word ..
                        (non-indent-word ..
                        (;something else, bracket, etc.
                        */

                        while ((letter = stream.eat(/[^\s\(\[\;\)\]]/)) != null) {
                            keyWord += letter;
                        }

                        if (keyWord.length > 0 && indentKeys.propertyIsEnumerable(keyWord)) { // indent-word

                            pushStack(state, indentTemp + INDENT_WORD_SKIP, ch);
                        } else { // non-indent word
                            // we continue eating the spaces
                            stream.eatSpace();
                            if (stream.eol() || stream.peek() == ";") {
                                // nothing significant after
                                // we restart indentation 1 space after
                                pushStack(state, indentTemp + 1, ch);
                            } else {
                                pushStack(state, indentTemp + stream.current().length, ch); // else we match
                            }
                        }
                        stream.backUp(stream.current().length - 1); // undo all the eating

                        if(typeof state.sExprComment == "number") state.sExprComment++;
                        if(typeof state.sExprQuote == "number") state.sExprQuote++;

                        returnType = BRACKET;
                    } else if (ch == ")" || ch == "]") {
                        returnType = BRACKET;
                        if (state.indentStack != null && state.indentStack.type == (ch == ")" ? "(" : "[")) {
                            popStack(state);

                            if(typeof state.sExprComment == "number"){
                                if(--state.sExprComment == 0){
                                    returnType = COMMENT; // final closing bracket
                                    state.sExprComment = false; // turn off s-expr commenting mode
                                }
                            }
                            if(typeof state.sExprQuote == "number"){
                                if(--state.sExprQuote == 0){
                                    returnType = ATOM; // final closing bracket
                                    state.sExprQuote = false; // turn off s-expr quote mode
                                }
                            }
                        }
                    } else {
                        stream.eatWhile(/[\w_\-!$%&*+\.\/:<=>?@\^~]/);

                        if (keywords && keywords.propertyIsEnumerable(stream.current())) {
                            returnType = BUILTIN;
                        } else returnType = "variable";
                    }
            }
            return (typeof state.sExprComment == "number") ? COMMENT : ((typeof state.sExprQuote == "number") ? ATOM : returnType);
        },

        indent: function (state) {
            if (state.indentStack == null) return state.indentation;
            return state.indentStack.indent;
        },

        closeBrackets: {pairs: "()[]{}\"\""},
        lineComment: ";;"
    };
});

CodeMirror.defineMIME("text/x-scheme", "scheme");

});
